nextflow_pipeline {

    name "Test nf-core-utils notification system"
    script "../notification-system/main.nf"

    test("Should import and test notification functions successfully") {
        
        when {
            params {
                // Use test parameters for notification system
            }
        }

        then {
            assert workflow.success
            assert workflow.exitStatus == 0
            
            // Verify basic pipeline execution markers
            assert workflow.stdout.any { it.contains("Pipeline is starting") }
            assert workflow.stdout.any { it.contains("Pipeline complete") }
            
            // Snapshot notification system outputs - testing successful execution
            // The detailed function testing happens in onComplete handler which may not be fully captured in stdout
            assert snapshot(
                workflow.stdout,
                workflow.exitStatus,
                workflow.success
            ).match("notification_system_success")
        }
    }

    test("Should handle notification function testing without errors") {
        
        when {
            params {
                // Notification function testing
            }
        }

        then {
            assert workflow.success
            assert workflow.exitStatus == 0
            
            // Verify workflow completed successfully
            assert workflow.stdout.any { it.contains("Pipeline complete") }
            
            // Snapshot successful execution
            assert snapshot(
                workflow.success,
                workflow.exitStatus
            ).match("notification_testing_complete")
        }
    }

    test("Should complete notification validation process") {
        
        when {
            params {
                // Validation completion test
            }
        }

        then {
            assert workflow.success
            assert workflow.exitStatus == 0
            
            // Pipeline should complete successfully with all functions tested
            assert workflow.stdout.any { it.contains("Pipeline complete") }
            
            // Snapshot successful validation
            assert snapshot(
                workflow.success,
                workflow.exitStatus
            ).match("notification_validation_success")
        }
    }
}